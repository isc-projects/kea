<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>BIND 10 Guide</title><link rel="stylesheet" type="text/css" href="./bind10-guide.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><meta name="description" content="BIND 10 is a framework that features Domain Name System (DNS) suite and Dynamic Host Configuration Protocol (DHCP) servers managed by Internet Systems Consortium (ISC). It includes DNS libraries, modular components for controlling authoritative and recursive DNS servers, and experimental DHCPv4 and DHCPv6 servers. This is the reference guide for BIND 10 version 20120127. The most up-to-date version of this document (in PDF, HTML, and plain text formats), along with other documents for BIND 10, can be found at ."></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" title="BIND 10 Guide"><div class="titlepage"><div><div><h1 class="title"><a name="idm14892896"></a>BIND 10 Guide</h1></div><div><h2 class="subtitle">Administrator Reference for BIND 10</h2></div><div><p class="releaseinfo">This is the reference guide for BIND 10 version
        20120127.</p></div><div><p class="copyright">Copyright © 2010-2012 Internet Systems Consortium, Inc.</p></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>BIND 10 is a framework that features Domain Name System
      (DNS) suite and Dynamic Host Configuration Protocol (DHCP)
      servers managed by Internet Systems Consortium (ISC). It
      includes DNS libraries, modular components for controlling
      authoritative and recursive DNS servers, and experimental DHCPv4
      and DHCPv6 servers.
      </p><p>
        This is the reference guide for BIND 10 version 20120127.
        The most up-to-date version of this document (in PDF, HTML,
        and plain text formats), along with other documents for
        BIND 10, can be found at <a class="ulink" href="http://bind10.isc.org/docs" target="_top">http://bind10.isc.org/docs</a>.
        </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="preface"><a href="#idp61424">Preface</a></span></dt><dd><dl><dt><span class="section"><a href="#acknowledgements">1. Acknowledgements</a></span></dt></dl></dd><dt><span class="chapter"><a href="#intro">1. Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#idp64344">1.1. Supported Platforms</a></span></dt><dt><span class="section"><a href="#required-software">1.2. Required Software</a></span></dt><dt><span class="section"><a href="#starting_stopping">1.3. Starting and Stopping the Server</a></span></dt><dt><span class="section"><a href="#managing_once_running">1.4. Managing BIND 10</a></span></dt></dl></dd><dt><span class="chapter"><a href="#installation">2. Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#build-requirements">2.1. Building Requirements</a></span></dt><dt><span class="section"><a href="#quickstart">2.2. Quick start</a></span></dt><dt><span class="section"><a href="#install">2.3. Installation from source</a></span></dt><dd><dl><dt><span class="section"><a href="#idp113000">2.3.1. Download Tar File</a></span></dt><dt><span class="section"><a href="#idp114472">2.3.2. Retrieve from Git</a></span></dt><dt><span class="section"><a href="#idp119504">2.3.3. Configure before the build</a></span></dt><dt><span class="section"><a href="#idp126792">2.3.4. Build</a></span></dt><dt><span class="section"><a href="#idp127848">2.3.5. Install</a></span></dt><dt><span class="section"><a href="#idp129504">2.3.6. Install Hierarchy</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#bind10">3. Starting BIND10 with <span class="command"><strong>bind10</strong></span></a></span></dt><dd><dl><dt><span class="section"><a href="#start">3.1. Starting BIND 10</a></span></dt><dt><span class="section"><a href="#bind10.config">3.2. Configuration of started processes</a></span></dt></dl></dd><dt><span class="chapter"><a href="#msgq">4. Command channel</a></span></dt><dt><span class="chapter"><a href="#cfgmgr">5. Configuration manager</a></span></dt><dt><span class="chapter"><a href="#cmdctl">6. Remote control daemon</a></span></dt><dd><dl><dt><span class="section"><a href="#cmdctl.spec">6.1. Configuration specification for b10-cmdctl</a></span></dt></dl></dd><dt><span class="chapter"><a href="#bindctl">7. Control and configure user interface</a></span></dt><dt><span class="chapter"><a href="#authserver">8. Authoritative Server</a></span></dt><dd><dl><dt><span class="section"><a href="#idp200360">8.1. Server Configurations</a></span></dt><dt><span class="section"><a href="#idp205096">8.2. Data Source Backends</a></span></dt><dt><span class="section"><a href="#idp207592">8.3. Loading Master Zones Files</a></span></dt></dl></dd><dt><span class="chapter"><a href="#xfrin">9. Incoming Zone Transfers</a></span></dt><dd><dl><dt><span class="section"><a href="#idp217864">9.1. Configuration for Incoming Zone Transfers</a></span></dt><dt><span class="section"><a href="#idp220904">9.2. Enabling IXFR</a></span></dt><dt><span class="section"><a href="#zonemgr">9.3. Secondary Manager</a></span></dt><dt><span class="section"><a href="#idp11976">9.4. Trigger an Incoming Zone Transfer Manually</a></span></dt></dl></dd><dt><span class="chapter"><a href="#xfrout">10. Outbound Zone Transfers</a></span></dt><dt><span class="chapter"><a href="#resolverserver">11. Recursive Name Server</a></span></dt><dd><dl><dt><span class="section"><a href="#idp259896">11.1. Access Control</a></span></dt><dt><span class="section"><a href="#idp269088">11.2. Forwarding</a></span></dt></dl></dd><dt><span class="chapter"><a href="#dhcp4">12. DHCPv4 Server</a></span></dt><dd><dl><dt><span class="section"><a href="#dhcp4-usage">12.1. DHCPv4 Server Usage</a></span></dt><dt><span class="section"><a href="#dhcp4-config">12.2. DHCPv4 Server Configuration</a></span></dt><dt><span class="section"><a href="#dhcp4-std">12.3. Supported standards</a></span></dt><dt><span class="section"><a href="#dhcp4-limit">12.4. DHCPv4 Server Limitations</a></span></dt></dl></dd><dt><span class="chapter"><a href="#dhcp6">13. DHCPv6 Server</a></span></dt><dd><dl><dt><span class="section"><a href="#dhcp6-usage">13.1. DHCPv6 Server Usage</a></span></dt><dt><span class="section"><a href="#dhcp6-config">13.2. DHCPv6 Server Configuration</a></span></dt><dt><span class="section"><a href="#dhcp6-std">13.3. Supported DHCPv6 Standards</a></span></dt><dt><span class="section"><a href="#dhcp6-limit">13.4. DHCPv6 Server Limitations</a></span></dt></dl></dd><dt><span class="chapter"><a href="#libdhcp">14. libdhcp++ library</a></span></dt><dd><dl><dt><span class="section"><a href="#iface-detect">14.1. Interface detection</a></span></dt><dt><span class="section"><a href="#packet-handling">14.2. DHCPv4/DHCPv6 packet handling</a></span></dt></dl></dd><dt><span class="chapter"><a href="#statistics">15. Statistics</a></span></dt><dt><span class="chapter"><a href="#logging">16. Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#idp327280">16.1. Logging configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#idp328272">16.1.1. Loggers</a></span></dt><dt><span class="section"><a href="#idp349480">16.1.2. Output Options</a></span></dt><dt><span class="section"><a href="#idp362088">16.1.3. Example session</a></span></dt></dl></dd><dt><span class="section"><a href="#idp379592">16.2. Logging Message Format</a></span></dt></dl></dd></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>3.1. <a href="#idp150584"></a></dt></dl></div><div class="preface" title="Preface"><div class="titlepage"><div><div><h2 class="title"><a name="idp61424"></a>Preface</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#acknowledgements">1. Acknowledgements</a></span></dt></dl></div><div class="section" title="1. Acknowledgements"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="acknowledgements"></a>1. Acknowledgements</h2></div></div></div><p>ISC would like to acknowledge generous support for
      BIND 10 development of DHCPv4 and DHCPv6 components provided
      by <a class="ulink" href="http://www.comcast.com/" target="_top">Comcast</a>.</p></div></div><div class="chapter" title="Chapter 1. Introduction"><div class="titlepage"><div><div><h2 class="title"><a name="intro"></a>Chapter 1. Introduction</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idp64344">1.1. Supported Platforms</a></span></dt><dt><span class="section"><a href="#required-software">1.2. Required Software</a></span></dt><dt><span class="section"><a href="#starting_stopping">1.3. Starting and Stopping the Server</a></span></dt><dt><span class="section"><a href="#managing_once_running">1.4. Managing BIND 10</a></span></dt></dl></div><p>
      BIND is the popular implementation of a DNS server, developer
      interfaces, and DNS tools.
      BIND 10 is a rewrite of BIND 9.  BIND 10 is written in C++ and Python
      and provides a modular environment for serving and maintaining DNS.
      BIND 10 provides a EDNS0- and DNSSEC-capable authoritative
      DNS server and a caching recursive name server which also
      provides forwarding.
    </p><p>
      This guide covers the experimental prototype of
      BIND 10 version 20120127.
    </p><div class="section" title="1.1. Supported Platforms"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp64344"></a>1.1. Supported Platforms</h2></div></div></div><p>
  BIND 10 builds have been tested on Debian GNU/Linux 5 and unstable,
  Ubuntu 9.10, NetBSD 5, Solaris 10, FreeBSD 7 and 8, CentOS
  Linux 5.3, and MacOS 10.6.

  It has been tested on Sparc, i386, and amd64 hardware
  platforms.

        It is planned for BIND 10 to build, install and run on
        Windows and standard Unix-type platforms.
      </p></div><div class="section" title="1.2. Required Software"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="required-software"></a>1.2. Required Software</h2></div></div></div><p>
        BIND 10 requires at least Python 3.1
        (<a class="ulink" href="http://www.python.org/" target="_top">http://www.python.org/</a>).
        It has also been tested with Python 3.2.
      </p><p>
        BIND 10 uses the Botan crypto library for C++
        (<a class="ulink" href="http://botan.randombit.net/" target="_top">http://botan.randombit.net/</a>).
        It requires at least Botan version 1.8.
      </p><p>
        BIND 10 uses the log4cplus C++ logging library
        (<a class="ulink" href="http://log4cplus.sourceforge.net/" target="_top">http://log4cplus.sourceforge.net/</a>).
        It requires at least log4cplus version 1.0.3.
      </p><p>
        The authoritative DNS server uses SQLite3
        (<a class="ulink" href="http://www.sqlite.org/" target="_top">http://www.sqlite.org/</a>).

        It needs at least SQLite version 3.3.9.
      </p><p>
        The <span class="command"><strong>b10-xfrin</strong></span>, <span class="command"><strong>b10-xfrout</strong></span>,
        and <span class="command"><strong>b10-zonemgr</strong></span> components require the
        libpython3 library and the Python _sqlite3.so module
        (which is included with Python).
        The Python module needs to be built for the corresponding Python 3.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          Some operating systems do not provide these dependencies
          in their default installation nor standard packages
          collections.
          You may need to install them separately.
        </p></div></div><div class="section" title="1.3. Starting and Stopping the Server"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="starting_stopping"></a>1.3. Starting and Stopping the Server</h2></div></div></div><p>
        BIND 10 is modular.  Part of this modularity is
        accomplished using multiple cooperating processes which, together,
        provide the server functionality.  This is a change from
        the previous generation of BIND software, which used a
        single process.
      </p><p>
        At first, running many different processes may seem confusing.
        However, these processes are started, stopped, and maintained
        by a single command, <span class="command"><strong>bind10</strong></span>.
        This command starts a master process which will start other
        processes as needed.
        The processes started by the <span class="command"><strong>bind10</strong></span>
        command have names starting with "b10-", including:
      </p><p>

        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
              <span class="command"><strong>b10-msgq</strong></span> &#8212;
              Message bus daemon.
              This process coordinates communication between all of the other
              BIND 10 processes.
            </li><li class="listitem">
              <span class="command"><strong>b10-auth</strong></span> &#8212;
              Authoritative DNS server.
              This process serves DNS requests.
            </li><li class="listitem">
              <span class="command"><strong>b10-cfgmgr</strong></span> &#8212;
              Configuration manager.
              This process maintains all of the configuration for BIND 10.
            </li><li class="listitem">
              <span class="command"><strong>b10-cmdctl</strong></span> &#8212;
              Command and control service.
              This process allows external control of the BIND 10 system.
            </li><li class="listitem">
              <span class="command"><strong>b10-resolver</strong></span> &#8212;
              Recursive name server.
              This process handles incoming queries.

            </li><li class="listitem">
              <span class="command"><strong>b10-stats</strong></span> &#8212;
              Statistics collection daemon.
              This process collects and reports statistics data.
            </li><li class="listitem">
              <span class="command"><strong>b10-xfrin</strong></span> &#8212;
              Incoming zone transfer service.
              This process is used to transfer a new copy
              of a zone into BIND 10, when acting as a secondary server.
            </li><li class="listitem">
              <span class="command"><strong>b10-xfrout</strong></span> &#8212;
              Outgoing zone transfer service.
              This process is used to handle transfer requests to
              send a local zone to a remote secondary server,
              when acting as a master server.
            </li><li class="listitem">
              <span class="command"><strong>b10-zonemgr</strong></span> &#8212;
              Secondary manager.
              This process keeps track of timers and other
              necessary information for BIND 10 to act as a slave server.
            </li></ul></div><p>
      </p><p>
        These are ran automatically by <span class="command"><strong>bind10</strong></span>
        and do not need to be run manually.
      </p></div><div class="section" title="1.4. Managing BIND 10"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="managing_once_running"></a>1.4. Managing BIND 10</h2></div></div></div><p>
        Once BIND 10 is running, a few commands are used to interact
        directly with the system:
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
              <span class="command"><strong>bindctl</strong></span> &#8212;
              interactive administration interface.
              This is a command-line tool which allows an administrator
              to control BIND 10.
            </li><li class="listitem">
              <span class="command"><strong>b10-loadzone</strong></span> &#8212;
              zone file loader.
              This tool will load standard masterfile-format zone files into
              BIND 10.
            </li><li class="listitem">
              <span class="command"><strong>b10-cmdctl-usermgr</strong></span> &#8212;
              user access control.
              This tool allows an administrator to authorize additional users
              to manage BIND 10.
            </li></ul></div><p>
      </p></div><p>
      The tools and modules are covered in full detail in this guide.

      In addition, manual pages are also provided in the default installation.
    </p><p>
      BIND 10 also provides libraries and programmer interfaces
      for C++ and Python for the message bus, configuration backend,
      and, of course, DNS. These include detailed developer
      documentation and code examples.

    </p></div><div class="chapter" title="Chapter 2. Installation"><div class="titlepage"><div><div><h2 class="title"><a name="installation"></a>Chapter 2. Installation</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#build-requirements">2.1. Building Requirements</a></span></dt><dt><span class="section"><a href="#quickstart">2.2. Quick start</a></span></dt><dt><span class="section"><a href="#install">2.3. Installation from source</a></span></dt><dd><dl><dt><span class="section"><a href="#idp113000">2.3.1. Download Tar File</a></span></dt><dt><span class="section"><a href="#idp114472">2.3.2. Retrieve from Git</a></span></dt><dt><span class="section"><a href="#idp119504">2.3.3. Configure before the build</a></span></dt><dt><span class="section"><a href="#idp126792">2.3.4. Build</a></span></dt><dt><span class="section"><a href="#idp127848">2.3.5. Install</a></span></dt><dt><span class="section"><a href="#idp129504">2.3.6. Install Hierarchy</a></span></dt></dl></dd></dl></div><div class="section" title="2.1. Building Requirements"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="build-requirements"></a>2.1. Building Requirements</h2></div></div></div><p>
          In addition to the run-time requirements, building BIND 10
          from source code requires various development include headers.
        </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Some operating systems have split their distribution packages into
            a run-time and a development package.  You will need to install
            the development package versions, which include header files and
            libraries, to build BIND 10 from source code.
          </p></div><p>
          Building from source code requires the Boost
          build-time headers
          (<a class="ulink" href="http://www.boost.org/" target="_top">http://www.boost.org/</a>).
          At least Boost version 1.35 is required.
  
  
        </p><p>
          To build BIND 10, also install the Botan (at least version
          1.8) and the log4cplus (at least version 1.0.3)
          development include headers.
        </p><p>
          Building BIND 10 also requires a C++ compiler and
          standard development headers, make, and pkg-config.
          BIND 10 builds have been tested with GCC g++ 3.4.3, 4.1.2,
          4.1.3, 4.2.1, 4.3.2, and 4.4.1; Clang++ 2.8; and Sun C++ 5.10.
        </p><p>
          Visit the wiki at <a class="ulink" href="http://bind10.isc.org/wiki/SystemSpecificNotes" target="_top">http://bind10.isc.org/wiki/SystemSpecificNotes</a>
          for system-specific installation tips.
        </p></div><div class="section" title="2.2. Quick start"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="quickstart"></a>2.2. Quick start</h2></div></div></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          This quickly covers the standard steps for installing
          and deploying BIND 10 as an authoritative name server using
          its defaults. For troubleshooting, full customizations and further
          details, see the respective chapters in the BIND 10 guide.
        </p></div><p>
        To quickly get started with BIND 10, follow these steps.
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
            Install required run-time and build dependencies.
          </li><li class="listitem">
            Download the BIND 10 source tar file from
            <a class="ulink" href="ftp://ftp.isc.org/isc/bind10/" target="_top">ftp://ftp.isc.org/isc/bind10/</a>.
          </li><li class="listitem"><p>Extract the tar file:
          </p><pre class="screen">$ <strong class="userinput"><code>gzcat bind10-<em class="replaceable"><code>VERSION</code></em>.tar.gz | tar -xvf -</code></strong></pre><p>
          </p></li><li class="listitem"><p>Go into the source and run configure:
            </p><pre class="screen">$ <strong class="userinput"><code>cd bind10-<em class="replaceable"><code>VERSION</code></em></code></strong>
  $ <strong class="userinput"><code>./configure</code></strong></pre><p>
          </p></li><li class="listitem"><p>Build it:
            </p><pre class="screen">$ <strong class="userinput"><code>make</code></strong></pre><p>
          </p></li><li class="listitem"><p>Install it (to default /usr/local):
            </p><pre class="screen">$ <strong class="userinput"><code>make install</code></strong></pre><p>
          </p></li><li class="listitem"><p>Start the server:
            </p><pre class="screen">$ <strong class="userinput"><code>/usr/local/sbin/bind10</code></strong></pre><p>
          </p></li><li class="listitem"><p>Test it; for example:
            </p><pre class="screen">$ <strong class="userinput"><code>dig @127.0.0.1 -c CH -t TXT authors.bind</code></strong></pre><p>
         </p></li><li class="listitem"><p>Load desired zone file(s), for example:
            </p><pre class="screen">$ <strong class="userinput"><code>b10-loadzone <em class="replaceable"><code>your.zone.example.org</code></em></code></strong></pre><p>
          </p></li><li class="listitem">
            Test the new zone.
          </li></ol></div></div><div class="section" title="2.3. Installation from source"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="install"></a>2.3. Installation from source</h2></div></div></div><p>
        BIND 10 is open source software written in C++ and Python.
        It is freely available in source code form from ISC via
        the Git code revision control system or as a downloadable
        tar file. It may also be available in pre-compiled ready-to-use
        packages from operating system vendors.
      </p><div class="section" title="2.3.1. Download Tar File"><div class="titlepage"><div><div><h3 class="title"><a name="idp113000"></a>2.3.1. Download Tar File</h3></div></div></div><p>
          Downloading a release tar file is the recommended method to
          obtain the source code.
        </p><p>
          The BIND 10 releases are available as tar file downloads from
          <a class="ulink" href="ftp://ftp.isc.org/isc/bind10/" target="_top">ftp://ftp.isc.org/isc/bind10/</a>.
          Periodic development snapshots may also be available.
        </p></div><div class="section" title="2.3.2. Retrieve from Git"><div class="titlepage"><div><div><h3 class="title"><a name="idp114472"></a>2.3.2. Retrieve from Git</h3></div></div></div><p>
          Downloading this "bleeding edge" code is recommended only for
          developers or advanced users.  Using development code in a production
          environment is not recommended.
        </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            When using source code retrieved via Git additional
            software will be required:  automake (v1.11 or newer),
            libtoolize, and autoconf (2.59 or newer).
            These may need to be installed.
          </p></div><p>
          The latest development code, including temporary experiments
          and un-reviewed code, is available via the BIND 10 code revision
          control system. This is powered by Git and all the BIND 10
          development is public.
          The leading development is done in the <span class="quote">&#8220;<span class="quote">master</span>&#8221;</span>.
        </p><p>
          The code can be checked out from
          <code class="filename">git://git.bind10.isc.org/bind10</code>;
          for example:

        </p><pre class="screen">$ <strong class="userinput"><code>git clone git://git.bind10.isc.org/bind10</code></strong></pre><p>
        </p><p>
          When checking out the code from
          the code version control system, it doesn't include the
          generated configure script, Makefile.in files, nor the
          related configure files.
          They can be created by running <span class="command"><strong>autoreconf</strong></span>
          with the <code class="option">--install</code> switch.
          This will run <span class="command"><strong>autoconf</strong></span>,
          <span class="command"><strong>aclocal</strong></span>,
          <span class="command"><strong>libtoolize</strong></span>,
          <span class="command"><strong>autoheader</strong></span>,
          <span class="command"><strong>automake</strong></span>,
          and related commands.
        </p></div><div class="section" title="2.3.3. Configure before the build"><div class="titlepage"><div><div><h3 class="title"><a name="idp119504"></a>2.3.3. Configure before the build</h3></div></div></div><p>
          BIND 10 uses the GNU Build System to discover build environment
          details.
          To generate the makefiles using the defaults, simply run:
          </p><pre class="screen">$ <strong class="userinput"><code>./configure</code></strong></pre><p>
        </p><p>
          Run <span class="command"><strong>./configure</strong></span> with the <code class="option">--help</code>
          switch to view the different options. The commonly-used options are:

          </p><div class="variablelist"><dl><dt><span class="term">--prefix</span></dt><dd>Define the installation location (the
                default is <code class="filename">/usr/local/</code>).
              </dd><dt><span class="term">--with-boost-include</span></dt><dd>Define the path to find the Boost headers.
              </dd><dt><span class="term">--with-pythonpath</span></dt><dd>Define the path to Python 3.1 if it is not in the
                standard execution path.
              </dd><dt><span class="term">--with-gtest</span></dt><dd>Enable building the C++ Unit Tests using the
                Google Tests framework. Optionally this can define the
                path to the gtest header files and library.
              </dd></dl></div><p>

        </p><p>
          For example, the following configures it to
    find the Boost headers, find the
    Python interpreter, and sets the installation location:

          </p><pre class="screen">$ <strong class="userinput"><code>./configure \
      --with-boost-include=/usr/pkg/include \
      --with-pythonpath=/usr/pkg/bin/python3.1 \
      --prefix=/opt/bind10</code></strong></pre><p>
        </p><p>
          If the configure fails, it may be due to missing or old
          dependencies.
        </p></div><div class="section" title="2.3.4. Build"><div class="titlepage"><div><div><h3 class="title"><a name="idp126792"></a>2.3.4. Build</h3></div></div></div><p>
    After the configure step is complete, to build the executables
    from the C++ code and prepare the Python scripts, run:

          </p><pre class="screen">$ <strong class="userinput"><code>make</code></strong></pre><p>
        </p></div><div class="section" title="2.3.5. Install"><div class="titlepage"><div><div><h3 class="title"><a name="idp127848"></a>2.3.5. Install</h3></div></div></div><p>
          To install the BIND 10 executables, support files,
          and documentation, run:
          </p><pre class="screen">$ <strong class="userinput"><code>make install</code></strong></pre><p>
        </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The install step may require superuser privileges.</p></div></div><div class="section" title="2.3.6. Install Hierarchy"><div class="titlepage"><div><div><h3 class="title"><a name="idp129504"></a>2.3.6. Install Hierarchy</h3></div></div></div><p>
          The following is the layout of the complete BIND 10 installation:
          </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
                <code class="filename">bin/</code> &#8212;
                general tools and diagnostic clients.
              </li><li class="listitem">
              <code class="filename">etc/bind10-devel/</code> &#8212;
              configuration files.
            </li><li class="listitem">
                <code class="filename">lib/</code> &#8212;
                libraries and python modules.
              </li><li class="listitem">
                <code class="filename">libexec/bind10-devel/</code> &#8212;
                executables that a user wouldn't normally run directly and
                are not run independently.
                These are the BIND 10 modules which are daemons started by
                the <span class="command"><strong>bind10</strong></span> tool.
              </li><li class="listitem">
                <code class="filename">sbin/</code> &#8212;
                commands used by the system administrator.
              </li><li class="listitem">
                <code class="filename">share/bind10-devel/</code> &#8212;
                configuration specifications.
              </li><li class="listitem">
                <code class="filename">share/man/</code> &#8212;
                manual pages (online documentation).
              </li><li class="listitem">
                <code class="filename">var/bind10-devel/</code> &#8212;
                data source and configuration databases.
              </li></ul></div><p>
        </p></div></div></div><div class="chapter" title="Chapter 3. Starting BIND10 with bind10"><div class="titlepage"><div><div><h2 class="title"><a name="bind10"></a>Chapter 3. Starting BIND10 with <span class="command"><strong>bind10</strong></span></h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#start">3.1. Starting BIND 10</a></span></dt><dt><span class="section"><a href="#bind10.config">3.2. Configuration of started processes</a></span></dt></dl></div><p>
      BIND 10 provides the <span class="command"><strong>bind10</strong></span> command which
      starts up the required processes.
      <span class="command"><strong>bind10</strong></span>
      will also restart some processes that exit unexpectedly.
      This is the only command needed to start the BIND 10 system.
    </p><p>
      After starting the <span class="command"><strong>b10-msgq</strong></span> communications channel,
      <span class="command"><strong>bind10</strong></span> connects to it,
      runs the configuration manager, and reads its own configuration.
      Then it starts the other modules.
    </p><p>
      The <span class="command"><strong>b10-sockcreator</strong></span>, <span class="command"><strong>b10-msgq</strong></span> and
      <span class="command"><strong>b10-cfgmgr</strong></span>
      services make up the core. The <span class="command"><strong>b10-msgq</strong></span> daemon
      provides the communication channel between every part of the system.
      The <span class="command"><strong>b10-cfgmgr</strong></span> daemon is always needed by every
      module, if only to send information about themselves somewhere,
      but more importantly to ask about their own settings, and
      about other modules. The <span class="command"><strong>b10-sockcreator</strong></span> will
      allocate sockets for the rest of the system.
    </p><p>
      In its default configuration, the <span class="command"><strong>bind10</strong></span>
      master process will also start up
      <span class="command"><strong>b10-cmdctl</strong></span> for admins to communicate with the
      system, <span class="command"><strong>b10-auth</strong></span> for authoritative DNS service,
      <span class="command"><strong>b10-stats</strong></span> for statistics collection,
      <span class="command"><strong>b10-xfrin</strong></span> for inbound DNS zone transfers,
      <span class="command"><strong>b10-xfrout</strong></span> for outbound DNS zone transfers,
      and <span class="command"><strong>b10-zonemgr</strong></span> for secondary service.
    </p><div class="section" title="3.1. Starting BIND 10"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="start"></a>3.1. Starting BIND 10</h2></div></div></div><p>
        To start the BIND 10 service, simply run <span class="command"><strong>bind10</strong></span>.
        Run it with the <code class="option">--verbose</code> switch to
        get additional debugging or diagnostic output.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          If the setproctitle Python module is detected at start up,
          the process names for the Python-based daemons will be renamed
          to better identify them instead of just <span class="quote">&#8220;<span class="quote">python</span>&#8221;</span>.
          This is not needed on some operating systems.
        </p></div></div><div class="section" title="3.2. Configuration of started processes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bind10.config"></a>3.2. Configuration of started processes</h2></div></div></div><p>
        The processes to be started can be configured, with the exception
        of the <span class="command"><strong>b10-sockcreator</strong></span>, <span class="command"><strong>b10-msgq</strong></span>
        and <span class="command"><strong>b10-cfgmgr</strong></span>.
      </p><p>
        The configuration is in the Boss/components section. Each element
        represents one component, which is an abstraction of a process
        (currently there's also one component which doesn't represent
        a process). If you didn't want to transfer out at all (your server
        is a slave only), you would just remove the corresponding component
        from the set, like this and the process would be stopped immediately
        (and not started on the next startup):
      </p><pre class="screen">&gt; <strong class="userinput"><code>config remove Boss/components b10-xfrout</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p><p>
        To add a process to the set, let's say the resolver (which not started
        by default), you would do this:
        </p><pre class="screen">&gt; <strong class="userinput"><code>config add Boss/components b10-resolver</code></strong>
&gt; <strong class="userinput"><code>config set Boss/components/b10-resolver/special resolver</code></strong>
&gt; <strong class="userinput"><code>config set Boss/components/b10-resolver/kind needed</code></strong>
&gt; <strong class="userinput"><code>config set Boss/components/b10-resolver/priority 10</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        Now, what it means. We add an entry called b10-resolver. It is both a
        name used to reference this component in the configuration and the
        name of the process to start. Then we set some parameters on how to
        start it.
      </p><p>
        The special one is for components that need some kind of special care
        during startup or shutdown. Unless specified, the component is started
        in usual way. This is the list of components that need to be started
        in a special way, with the value of special used for them:
        </p><div class="table"><a name="idp150584"></a><p class="title"><b>Table 3.1. </b></p><div class="table-contents"><table border="1"><colgroup><col align="left" class="component"><col align="left" class="special"><col align="left" class="description"></colgroup><thead><tr><th align="left">Component</th><th align="left">Special</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">b10-auth</td><td align="left">auth</td><td align="left">Authoritative server</td></tr><tr><td align="left">b10-resolver</td><td align="left">resolver</td><td align="left">The resolver</td></tr><tr><td align="left">b10-cmdctl</td><td align="left">cmdctl</td><td align="left">The command control (remote control interface)</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><p>
        The kind specifies how a failure of the component should
        be handled.  If it is set to <span class="quote">&#8220;<span class="quote">dispensable</span>&#8221;</span>
        (the default unless you set something else), it will get
        started again if it fails. If it is set to <span class="quote">&#8220;<span class="quote">needed</span>&#8221;</span>
        and it fails at startup, the whole <span class="command"><strong>bind10</strong></span>
        shuts down and exits with error exit code. But if it fails
        some time later, it is just started again. If you set it
        to <span class="quote">&#8220;<span class="quote">core</span>&#8221;</span>, you indicate that the system is
        not usable without the component and if such component
        fails, the system shuts down no matter when the failure
        happened.  This is the behaviour of the core components
        (the ones you can't turn off), but you can declare any
        other components as core as well if you wish (but you can
        turn these off, they just can't fail).
      </p><p>
        The priority defines order in which the components should start.
        The ones with higher number are started sooner than the ones with
        lower ones. If you don't set it, 0 (zero) is used as the priority.
        Usually, leaving it at the default is enough.
      </p><p>
        There are other parameters we didn't use in our example.
        One of them is <span class="quote">&#8220;<span class="quote">address</span>&#8221;</span>. It is the address
        used by the component on the <span class="command"><strong>b10-msgq</strong></span>
        message bus. The special components already know their
        address, but the usual ones don't. The address is by
        convention the thing after <span class="emphasis"><em>b10-</em></span>, with
        the first letter capital (eg. <span class="command"><strong>b10-stats</strong></span>
        would have <span class="quote">&#8220;<span class="quote">Stats</span>&#8221;</span> as its address).

      </p><p>
        The last one is process. It is the name of the process to be started.
        It defaults to the name of the component if not set, but you can use
        this to override it.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          This system allows you to start the same component multiple times
          (by including it in the configuration with different names, but the
          same process setting). However, the rest of the system doesn't expect
          such situation, so it would probably not do what you want. Such
          support is yet to be implemented.
        </p></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The configuration is quite powerful, but that includes
          a lot of space for mistakes. You could turn off the
          <span class="command"><strong>b10-cmdctl</strong></span>, but then you couldn't
          change it back the usual way, as it would require it to
          be running (you would have to find and edit the configuration
          directly).  Also, some modules might have dependencies
          -- <span class="command"><strong>b10-stats-httpd</strong></span> need
          <span class="command"><strong>b10-stats</strong></span>, <span class="command"><strong>b10-xfrout</strong></span>
          needs the <span class="command"><strong>b10-auth</strong></span> to be running, etc.



        </p><p>
          In short, you should think twice before disabling something here.
        </p></div><p>
        It is possible to start some components multiple times (currently
        <span class="command"><strong>b10-auth</strong></span> and <span class="command"><strong>b10-resolzer</strong></span>).
        You might want to do that to gain more performance (each one uses only
        single core). Just put multiple entries under different names, like
        this, with the same config:
        </p><pre class="screen">&gt; <strong class="userinput"><code>config add Boss/components b10-resolver-2</code></strong>
&gt; <strong class="userinput"><code>config set Boss/components/b10-resolver-2/special resolver</code></strong>
&gt; <strong class="userinput"><code>config set Boss/components/b10-resolver-2/kind needed</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p><p>
        However, this is work in progress and the support is not yet complete.
        For example, each resolver will have its own cache, each authoritative
        server will keep its own copy of in-memory data and there could be
        problems with locking the sqlite database, if used. The configuration
        might be changed to something more convenient in future.
      </p></div></div><div class="chapter" title="Chapter 4. Command channel"><div class="titlepage"><div><div><h2 class="title"><a name="msgq"></a>Chapter 4. Command channel</h2></div></div></div><p>
        The BIND 10 components use the <span class="command"><strong>b10-msgq</strong></span>
        message routing daemon to communicate with other BIND 10 components.
        The <span class="command"><strong>b10-msgq</strong></span> implements what is called the
        <span class="quote">&#8220;<span class="quote">Command Channel</span>&#8221;</span>.
        Processes intercommunicate by sending messages on the command
        channel.
        Example messages include shutdown, get configurations, and set
        configurations.
        This Command Channel is not used for DNS message passing.
        It is used only to control and monitor the BIND 10 system.
      </p><p>
        Administrators do not communicate directly with the
        <span class="command"><strong>b10-msgq</strong></span> daemon.
        By default, BIND 10 uses port 9912 for the
        <span class="command"><strong>b10-msgq</strong></span> service.
        It listens on 127.0.0.1.
      </p></div><div class="chapter" title="Chapter 5. Configuration manager"><div class="titlepage"><div><div><h2 class="title"><a name="cfgmgr"></a>Chapter 5. Configuration manager</h2></div></div></div><p>
         The configuration manager, <span class="command"><strong>b10-cfgmgr</strong></span>,
         handles all BIND 10 system configuration.  It provides
         persistent storage for configuration, and notifies running
         modules of configuration changes.
      </p><p>
        The <span class="command"><strong>b10-auth</strong></span> and <span class="command"><strong>b10-xfrin</strong></span>
        daemons and other components receive their configurations
        from the configuration manager over the <span class="command"><strong>b10-msgq</strong></span>
        command channel.
      </p><p>The administrator doesn't connect to it directly, but
        uses a user interface to communicate with the configuration
        manager via <span class="command"><strong>b10-cmdctl</strong></span>'s REST-ful interface.
        <span class="command"><strong>b10-cmdctl</strong></span> is covered in <a class="xref" href="#cmdctl" title="Chapter 6. Remote control daemon">Chapter 6, <i>Remote control daemon</i></a>.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The development prototype release only provides the
          <span class="command"><strong>bindctl</strong></span> as a user interface to
          <span class="command"><strong>b10-cmdctl</strong></span>.
          Upcoming releases will provide another interactive command-line
          interface and a web-based interface.
        </p></div><p>
        The <span class="command"><strong>b10-cfgmgr</strong></span> daemon can send all
        specifications and all current settings to the
        <span class="command"><strong>bindctl</strong></span> client (via
        <span class="command"><strong>b10-cmdctl</strong></span>).
      </p><p>
        <span class="command"><strong>b10-cfgmgr</strong></span> relays configurations received
        from <span class="command"><strong>b10-cmdctl</strong></span> to the appropriate modules.
      </p><p>
        The stored configuration file is at
        <code class="filename">/usr/local/var/bind10-devel/b10-config.db</code>.
        (The full path is what was defined at build configure time for
        <code class="option">--localstatedir</code>.
        The default is <code class="filename">/usr/local/var/</code>.)
        The format is loosely based on JSON and is directly parseable
        python, but this may change in a future version.
        This configuration data file is not manually edited by the
        administrator.
      </p><p>
      The configuration manager does not have any command line arguments.
      Normally it is not started manually, but is automatically
      started using the <span class="command"><strong>bind10</strong></span> master process
      (as covered in <a class="xref" href="#bind10" title="Chapter 3. Starting BIND10 with bind10">Chapter 3, <i>Starting BIND10 with <span class="command"><strong>bind10</strong></span></i></a>).
    </p></div><div class="chapter" title="Chapter 6. Remote control daemon"><div class="titlepage"><div><div><h2 class="title"><a name="cmdctl"></a>Chapter 6. Remote control daemon</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#cmdctl.spec">6.1. Configuration specification for b10-cmdctl</a></span></dt></dl></div><p>
      <span class="command"><strong>b10-cmdctl</strong></span> is the gateway between
      administrators and the BIND 10 system.
      It is a HTTPS server that uses standard HTTP Digest
      Authentication for username and password validation.
      It provides a REST-ful interface for accessing and controlling
      BIND 10.
    </p><p>
      When <span class="command"><strong>b10-cmdctl</strong></span> starts, it firsts
      asks <span class="command"><strong>b10-cfgmgr</strong></span> about what modules are
      running and what their configuration is (over the
      <span class="command"><strong>b10-msgq</strong></span> channel). Then it will start listening
      on HTTPS for clients &#8212; the user interface &#8212; such
      as <span class="command"><strong>bindctl</strong></span>.
    </p><p>
      <span class="command"><strong>b10-cmdctl</strong></span> directly sends commands
      (received from the user interface) to the specified component.
      Configuration changes are actually commands to
      <span class="command"><strong>b10-cfgmgr</strong></span> so are sent there.
    </p><p>The HTTPS server requires a private key,
      such as a RSA PRIVATE KEY.
      The default location is at
      <code class="filename">/usr/local/etc/bind10-devel/cmdctl-keyfile.pem</code>.
      (A sample key is at
      <code class="filename">/usr/local/share/bind10-devel/cmdctl-keyfile.pem</code>.)
      It also uses a certificate located at
      <code class="filename">/usr/local/etc/bind10-devel/cmdctl-certfile.pem</code>.
      (A sample certificate is at
      <code class="filename">/usr/local/share/bind10-devel/cmdctl-certfile.pem</code>.)
      This may be a self-signed certificate or purchased from a
      certification authority.
    </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      The HTTPS server doesn't support a certificate request from a
      client (at this time).

      The <span class="command"><strong>b10-cmdctl</strong></span> daemon does not provide a
      public service. If any client wants to control BIND 10, then
      a certificate needs to be first received from the BIND 10
      administrator.
      The BIND 10 installation provides a sample PEM bundle that matches
      the sample key and certificate.
    </p></div><p>
      The <span class="command"><strong>b10-cmdctl</strong></span> daemon also requires
      the user account file located at
      <code class="filename">/usr/local/etc/bind10-devel/cmdctl-accounts.csv</code>.
      This comma-delimited file lists the accounts with a user name,
      hashed password, and salt.
      (A sample file is at
      <code class="filename">/usr/local/share/bind10-devel/cmdctl-accounts.csv</code>.
      It contains the user named <span class="quote">&#8220;<span class="quote">root</span>&#8221;</span> with the password
      <span class="quote">&#8220;<span class="quote">bind10</span>&#8221;</span>.)
    </p><p>
      The administrator may create a user account with the
      <span class="command"><strong>b10-cmdctl-usermgr</strong></span> tool.
    </p><p>
      By default the HTTPS server listens on the localhost port 8080.
      The port can be set by using the <code class="option">--port</code> command line option.
      The address to listen on can be set using the <code class="option">--address</code> command
      line argument.
      Each HTTPS connection is stateless and timesout in 1200 seconds
      by default.  This can be
      redefined by using the <code class="option">--idle-timeout</code> command line argument.
    </p><div class="section" title="6.1. Configuration specification for b10-cmdctl"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cmdctl.spec"></a>6.1. Configuration specification for b10-cmdctl</h2></div></div></div><p>
        The configuration items for <span class="command"><strong>b10-cmdctl</strong></span> are:
key_file
cert_file
accounts_file
      </p><p>
        The control commands are:
print_settings


shutdown
      </p></div></div><div class="chapter" title="Chapter 7. Control and configure user interface"><div class="titlepage"><div><div><h2 class="title"><a name="bindctl"></a>Chapter 7. Control and configure user interface</h2></div></div></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      For this development prototype release, <span class="command"><strong>bindctl</strong></span>
      is the only user interface. It is expected that upcoming
      releases will provide another interactive command-line
      interface and a web-based interface for controlling and
      configuring BIND 10.
    </p></div><p>
      The <span class="command"><strong>bindctl</strong></span> tool provides an interactive
      prompt for configuring, controlling, and querying the BIND 10
      components.
      It communicates directly with a REST-ful interface over HTTPS
      provided by <span class="command"><strong>b10-cmdctl</strong></span>. It doesn't
      communicate to any other components directly.
    </p><p>
      Configuration changes are actually commands to
      <span class="command"><strong>b10-cfgmgr</strong></span>. So when <span class="command"><strong>bindctl</strong></span>
      sends a configuration, it is sent to <span class="command"><strong>b10-cmdctl</strong></span>
      (over a HTTPS connection); then <span class="command"><strong>b10-cmdctl</strong></span>
      sends the command (over a <span class="command"><strong>b10-msgq</strong></span> command
      channel) to <span class="command"><strong>b10-cfgmgr</strong></span> which then stores
      the details and relays (over a <span class="command"><strong>b10-msgq</strong></span> command
      channel) the configuration on to the specified module.
    </p><p>
    </p></div><div class="chapter" title="Chapter 8. Authoritative Server"><div class="titlepage"><div><div><h2 class="title"><a name="authserver"></a>Chapter 8. Authoritative Server</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idp200360">8.1. Server Configurations</a></span></dt><dt><span class="section"><a href="#idp205096">8.2. Data Source Backends</a></span></dt><dt><span class="section"><a href="#idp207592">8.3. Loading Master Zones Files</a></span></dt></dl></div><p>
      The <span class="command"><strong>b10-auth</strong></span> is the authoritative DNS server.
      It supports EDNS0 and DNSSEC. It supports IPv6.
      Normally it is started by the <span class="command"><strong>bind10</strong></span> master
      process.
    </p><div class="section" title="8.1. Server Configurations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp200360"></a>8.1. Server Configurations</h2></div></div></div><p>
        <span class="command"><strong>b10-auth</strong></span> is configured via the
        <span class="command"><strong>b10-cfgmgr</strong></span> configuration manager.
        The module name is <span class="quote">&#8220;<span class="quote">Auth</span>&#8221;</span>.
        The configuration data item is:

        </p><div class="variablelist"><dl><dt><span class="term">database_file</span></dt><dd>This is an optional string to define the path to find
                 the SQLite3 database file.

Note: Later the DNS server will use various data source backends.
This may be a temporary setting until then.
              </dd></dl></div><p>

      </p><p>

        The configuration command is:

        </p><div class="variablelist"><dl><dt><span class="term">shutdown</span></dt><dd>Stop the authoritative DNS server.
              </dd></dl></div><p>

      </p></div><div class="section" title="8.2. Data Source Backends"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp205096"></a>8.2. Data Source Backends</h2></div></div></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        For the development prototype release, <span class="command"><strong>b10-auth</strong></span>
        supports a SQLite3 data source backend and in-memory data source
        backend.
        Upcoming versions will be able to use multiple different
        data sources, such as MySQL and Berkeley DB.
      </p></div><p>
        By default, the SQLite3 backend uses the data file located at
        <code class="filename">/usr/local/var/bind10-devel/zone.sqlite3</code>.
        (The full path is what was defined at build configure time for
        <code class="option">--localstatedir</code>.
        The default is <code class="filename">/usr/local/var/</code>.)
  This data file location may be changed by defining the
  <span class="quote">&#8220;<span class="quote">database_file</span>&#8221;</span> configuration.
      </p></div><div class="section" title="8.3. Loading Master Zones Files"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp207592"></a>8.3. Loading Master Zones Files</h2></div></div></div><p>
        RFC 1035 style DNS master zone files may imported
        into a BIND 10 data source by using the
        <span class="command"><strong>b10-loadzone</strong></span> utility.
      </p><p>
        <span class="command"><strong>b10-loadzone</strong></span> supports the following
        special directives (control entries):

        </p><div class="variablelist"><dl><dt><span class="term">$INCLUDE</span></dt><dd>Loads an additional zone file. This may be recursive.
              </dd><dt><span class="term">$ORIGIN</span></dt><dd>Defines the relative domain name.
              </dd><dt><span class="term">$TTL</span></dt><dd>Defines the time-to-live value used for following
                records that don't include a TTL.
              </dd></dl></div><p>

      </p><p>
        The <code class="option">-o</code> argument may be used to define the
        default origin for loaded zone file records.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        In the development prototype release, only the SQLite3 back
        end is used.
        By default, it stores the zone data in
        <code class="filename">/usr/local/var/bind10-devel/zone.sqlite3</code>
        unless the <code class="option">-d</code> switch is used to set the
        database filename.
        Multiple zones are stored in a single SQLite3 zone database.
      </p></div><p>
        If you reload a zone already existing in the database,
        all records from that prior zone disappear and a whole new set
        appears.
      </p></div></div><div class="chapter" title="Chapter 9. Incoming Zone Transfers"><div class="titlepage"><div><div><h2 class="title"><a name="xfrin"></a>Chapter 9. Incoming Zone Transfers</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idp217864">9.1. Configuration for Incoming Zone Transfers</a></span></dt><dt><span class="section"><a href="#idp220904">9.2. Enabling IXFR</a></span></dt><dt><span class="section"><a href="#zonemgr">9.3. Secondary Manager</a></span></dt><dt><span class="section"><a href="#idp11976">9.4. Trigger an Incoming Zone Transfer Manually</a></span></dt></dl></div><p>
      Incoming zones are transferred using the <span class="command"><strong>b10-xfrin</strong></span>
      process which is started by <span class="command"><strong>bind10</strong></span>.
      When received, the zone is stored in the corresponding BIND 10
      data source, and its records can be served by
      <span class="command"><strong>b10-auth</strong></span>.
      In combination with <span class="command"><strong>b10-zonemgr</strong></span> (for
      automated SOA checks), this allows the BIND 10 server to
      provide <span class="quote">&#8220;<span class="quote">secondary</span>&#8221;</span> service.
    </p><p>
      The <span class="command"><strong>b10-xfrin</strong></span> process supports both AXFR and
      IXFR.  Due to some implementation limitations of the current
      development release, however, it only tries AXFR by default,
      and care should be taken to enable IXFR.
    </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
     In the current development release of BIND 10, incoming zone
     transfers are only available for SQLite3-based data sources,
     that is, they don't work for an in-memory data source.
    </p></div><div class="section" title="9.1. Configuration for Incoming Zone Transfers"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp217864"></a>9.1. Configuration for Incoming Zone Transfers</h2></div></div></div><p>
        In practice, you need to specify a list of secondary zones to
        enable incoming zone transfers for these zones (you can still
        trigger a zone transfer manually, without a prior configuration
        (see below)).
      </p><p>
        For example, to enable zone transfers for a zone named "example.com"
        (whose master address is assumed to be 2001:db8::53 here),
        run the following at the <span class="command"><strong>bindctl</strong></span> prompt:

      </p><pre class="screen">&gt; <strong class="userinput"><code>config add Xfrin/zones</code></strong>
&gt; <strong class="userinput"><code>config set Xfrin/zones[0]/name "<code class="option">example.com</code>"</code></strong>
&gt; <strong class="userinput"><code>config set Xfrin/zones[0]/master_addr "<code class="option">2001:db8::53</code>"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>

      (We assume there has been no zone configuration before).
      </p></div><div class="section" title="9.2. Enabling IXFR"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp220904"></a>9.2. Enabling IXFR</h2></div></div></div><p>
        As noted above, <span class="command"><strong>b10-xfrin</strong></span> uses AXFR for
        zone transfers by default.  To enable IXFR for zone transfers
        for a particular zone, set the <strong class="userinput"><code>use_ixfr</code></strong>
        configuration parameter to <strong class="userinput"><code>true</code></strong>.
        In the above example of configuration sequence, you'll need
        to add the following before performing <strong class="userinput"><code>commit</code></strong>:
      </p><pre class="screen">&gt; <strong class="userinput"><code>config set Xfrin/zones[0]/use_ixfr true</code></strong></pre><p>
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      One reason why IXFR is disabled by default in the current
      release is because it does not support automatic fallback from IXFR to
      AXFR when it encounters a primary server that doesn't support
      outbound IXFR (and, not many existing implementations support
      it).  Another, related reason is that it does not use AXFR even
      if it has no knowledge about the zone (like at the very first
      time the secondary server is set up).  IXFR requires the
      "current version" of the zone, so obviously it doesn't work
      in this situation and AXFR is the only workable choice.
      The current release of <span class="command"><strong>b10-xfrin</strong></span> does not
      make this selection automatically.
      These features will be implemented in a near future
      version, at which point we will enable IXFR by default.
      </p></div></div><div class="section" title="9.3. Secondary Manager"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="zonemgr"></a>9.3. Secondary Manager</h2></div></div></div><p>
        The <span class="command"><strong>b10-zonemgr</strong></span> process is started by
        <span class="command"><strong>bind10</strong></span>.
        It keeps track of SOA refresh, retry, and expire timers
        and other details for BIND 10 to perform as a slave.
        When the <span class="command"><strong>b10-auth</strong></span> authoritative DNS server
        receives a NOTIFY message, <span class="command"><strong>b10-zonemgr</strong></span>
        may tell <span class="command"><strong>b10-xfrin</strong></span> to do a refresh
        to start an inbound zone transfer.
        The secondary manager resets its counters when a new zone is
        transferred in.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Access control (such as allowing notifies) is not yet provided.
        The primary/secondary service is not yet complete.
      </p></div><p>
        The following example shows using <span class="command"><strong>bindctl</strong></span>
        to configure the server to be a secondary for the example zone:

      </p><pre class="screen">&gt; <strong class="userinput"><code>config add Zonemgr/secondary_zones</code></strong>
&gt; <strong class="userinput"><code>config set Zonemgr/secondary_zones[0]/name "<code class="option">example.com</code>"</code></strong>
&gt; <strong class="userinput"><code>config set Zonemgr/secondary_zones[0]/class "<code class="option">IN</code>"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>



      </p><p>
        If the zone does not exist in the data source already
        (i.e. no SOA record for it), <span class="command"><strong>b10-zonemgr</strong></span>
        will automatically tell <span class="command"><strong>b10-xfrin</strong></span>
        to transfer the zone in.
      </p></div><div class="section" title="9.4. Trigger an Incoming Zone Transfer Manually"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp11976"></a>9.4. Trigger an Incoming Zone Transfer Manually</h2></div></div></div><p>
        To manually trigger a zone transfer to retrieve a remote zone,
        you may use the <span class="command"><strong>bindctl</strong></span> utility.
        For example, at the <span class="command"><strong>bindctl</strong></span> prompt run:

        </p><pre class="screen">&gt; <strong class="userinput"><code>Xfrin retransfer zone_name="<code class="option">foo.example.org</code>" master=<code class="option">192.0.2.99</code></code></strong></pre><p>
      </p></div></div><div class="chapter" title="Chapter 10. Outbound Zone Transfers"><div class="titlepage"><div><div><h2 class="title"><a name="xfrout"></a>Chapter 10. Outbound Zone Transfers</h2></div></div></div><p>
      The <span class="command"><strong>b10-xfrout</strong></span> process is started by
      <span class="command"><strong>bind10</strong></span>.
      When the <span class="command"><strong>b10-auth</strong></span> authoritative DNS server
      receives an AXFR or IXFR request, <span class="command"><strong>b10-auth</strong></span>
      internally forwards the request to <span class="command"><strong>b10-xfrout</strong></span>,
      which handles the rest of request processing.
      This is used to provide primary DNS service to share zones
      to secondary name servers.
      The <span class="command"><strong>b10-xfrout</strong></span> is also used to send
      NOTIFY messages to secondary servers.
    </p><p>
      A global or per zone <code class="option">transfer_acl</code> configuration
      can be used to control accessibility of the outbound zone
      transfer service.
      By default, <span class="command"><strong>b10-xfrout</strong></span> allows any clients to
      perform zone transfers for any zones:
    </p><pre class="screen">&gt; <strong class="userinput"><code>config show Xfrout/transfer_acl</code></strong>
Xfrout/transfer_acl[0]	{"action": "ACCEPT"}	any	(default)</pre><p>
      You can change this to, for example, rejecting all transfer
      requests by default while allowing requests for the transfer
      of zone "example.com" from 192.0.2.1 and 2001:db8::1 as follows:
    </p><pre class="screen">&gt; <strong class="userinput"><code>config set Xfrout/transfer_acl[0] {"action": "REJECT"}</code></strong>
&gt; <strong class="userinput"><code>config add Xfrout/zone_config</code></strong>
&gt; <strong class="userinput"><code>config set Xfrout/zone_config[0]/origin "example.com"</code></strong>
&gt; <strong class="userinput"><code>config set Xfrout/zone_config[0]/transfer_acl [{"action": "ACCEPT", "from": "192.0.2.1"},</code></strong>
<strong class="userinput"><code>                                                 {"action": "ACCEPT", "from": "2001:db8::1"}]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        In the above example the lines
        for <code class="option">transfer_acl</code> were divided for
        readability.  In the actual input it must be in a single line.
    </p></div><p>
      If you want to require TSIG in access control, a separate TSIG
      "key ring" must be configured specifically
      for <span class="command"><strong>b10-xfrout</strong></span> as well as a system wide
      key ring, both containing a consistent set of keys.
      For example, to change the previous example to allowing requests
      from 192.0.2.1 signed by a TSIG with a key name of
      "key.example", you'll need to do this:
    </p><pre class="screen">&gt; <strong class="userinput"><code>config set tsig_keys/keys ["key.example:&lt;base64-key&gt;"]</code></strong>
&gt; <strong class="userinput"><code>config set Xfrout/tsig_keys/keys ["key.example:&lt;base64-key&gt;"]</code></strong>
&gt; <strong class="userinput"><code>config set Xfrout/zone_config[0]/transfer_acl [{"action": "ACCEPT", "from": "192.0.2.1", "key": "key.example"}]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      The first line of configuration defines a system wide key ring.
      This is necessary because the <span class="command"><strong>b10-auth</strong></span> server
      also checks TSIGs and it uses the system wide configuration.
    </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        In a future version, <span class="command"><strong>b10-xfrout</strong></span> will also
        use the system wide TSIG configuration.
        The way to specify zone specific configuration (ACLs, etc) is
        likely to be changed, too.
    </p></div></div><div class="chapter" title="Chapter 11. Recursive Name Server"><div class="titlepage"><div><div><h2 class="title"><a name="resolverserver"></a>Chapter 11. Recursive Name Server</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idp259896">11.1. Access Control</a></span></dt><dt><span class="section"><a href="#idp269088">11.2. Forwarding</a></span></dt></dl></div><p>
      The <span class="command"><strong>b10-resolver</strong></span> process is started by
      <span class="command"><strong>bind10</strong></span>.

    </p><p>
      The main <span class="command"><strong>bind10</strong></span> process can be configured
      to select to run either the authoritative or resolver or both.
      By default, it starts the authoritative service.


      You may change this using <span class="command"><strong>bindctl</strong></span>, for example:

      </p><pre class="screen">
&gt; <strong class="userinput"><code>config remove Boss/components b10-xfrout</code></strong>
&gt; <strong class="userinput"><code>config remove Boss/components b10-xfrin</code></strong>
&gt; <strong class="userinput"><code>config remove Boss/components b10-auth</code></strong>
&gt; <strong class="userinput"><code>config add Boss/components b10-resolver</code></strong>
&gt; <strong class="userinput"><code>config set Boss/components/b10-resolver/special resolver</code></strong>
&gt; <strong class="userinput"><code>config set Boss/components/b10-resolver/kind needed</code></strong>
&gt; <strong class="userinput"><code>config set Boss/components/b10-resolver/priority 10</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>

    </p><p>
       The master <span class="command"><strong>bind10</strong></span> will stop and start
       the desired services.
    </p><p>
      By default, the resolver listens on port 53 for 127.0.0.1 and ::1.
      The following example shows how it can be configured to
      listen on an additional address (and port):

      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Resolver/listen_on</code></strong>
&gt; <strong class="userinput"><code>config set Resolver/listen_on[<em class="replaceable"><code>2</code></em>]/address "192.168.1.1"</code></strong>
&gt; <strong class="userinput"><code>config set Resolver/listen_on[<em class="replaceable"><code>2</code></em>]/port 53</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
    </p><p>(Replace the <span class="quote">&#8220;<span class="quote"><em class="replaceable"><code>2</code></em></span>&#8221;</span>
       as needed; run <span class="quote">&#8220;<span class="quote"><strong class="userinput"><code>config show
       Resolver/listen_on</code></strong></span>&#8221;</span> if needed.)</p><div class="section" title="11.1. Access Control"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp259896"></a>11.1. Access Control</h2></div></div></div><p>
        By default, the <span class="command"><strong>b10-resolver</strong></span> daemon only accepts
        DNS queries from the localhost (127.0.0.1 and ::1).
        The <code class="option">Resolver/query_acl</code> configuration may
        be used to reject, drop, or allow specific IPs or networks.
        This configuration list is first match.
      </p><p>
        The configuration's <code class="option">action</code> item may be
        set to <span class="quote">&#8220;<span class="quote">ACCEPT</span>&#8221;</span> to allow the incoming query,
        <span class="quote">&#8220;<span class="quote">REJECT</span>&#8221;</span> to respond with a DNS REFUSED return
        code, or <span class="quote">&#8220;<span class="quote">DROP</span>&#8221;</span> to ignore the query without
        any response (such as a blackhole).  For more information,
        see the respective debugging messages:  <a class="ulink" href="bind10-messages.html#RESOLVER_QUERY_ACCEPTED" target="_top">RESOLVER_QUERY_ACCEPTED</a>,
        <a class="ulink" href="bind10-messages.html#RESOLVER_QUERY_REJECTED" target="_top">RESOLVER_QUERY_REJECTED</a>,
        and <a class="ulink" href="bind10-messages.html#RESOLVER_QUERY_DROPPED" target="_top">RESOLVER_QUERY_DROPPED</a>.
      </p><p>
        The required configuration's <code class="option">from</code> item is set
        to an IPv4 or IPv6 address, addresses with an network mask, or to
        the special lowercase keywords <span class="quote">&#8220;<span class="quote">any6</span>&#8221;</span> (for
        any IPv6 address) or <span class="quote">&#8220;<span class="quote">any4</span>&#8221;</span> (for any IPv4
        address).
      </p><p>
        For example to allow the <em class="replaceable"><code>192.168.1.0/24</code></em>
        network to use your recursive name server, at the
        <span class="command"><strong>bindctl</strong></span> prompt run:
      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Resolver/query_acl</code></strong>
&gt; <strong class="userinput"><code>config set Resolver/query_acl[<em class="replaceable"><code>2</code></em>]/action "ACCEPT"</code></strong>
&gt; <strong class="userinput"><code>config set Resolver/query_acl[<em class="replaceable"><code>2</code></em>]/from "<em class="replaceable"><code>192.168.1.0/24</code></em>"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>(Replace the <span class="quote">&#8220;<span class="quote"><em class="replaceable"><code>2</code></em></span>&#8221;</span>
       as needed; run <span class="quote">&#8220;<span class="quote"><strong class="userinput"><code>config show
       Resolver/query_acl</code></strong></span>&#8221;</span> if needed.)</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>This prototype access control configuration
      syntax may be changed.</p></div></div><div class="section" title="11.2. Forwarding"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp269088"></a>11.2. Forwarding</h2></div></div></div><p>

        To enable forwarding, the upstream address and port must be
        configured to forward queries to, such as:

        </p><pre class="screen">
&gt; <strong class="userinput"><code>config set Resolver/forward_addresses [{ "address": "<em class="replaceable"><code>192.168.1.1</code></em>", "port": 53 }]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>

        (Replace <em class="replaceable"><code>192.168.1.1</code></em> to point to your
        full resolver.)
      </p><p>
        Normal iterative name service can be re-enabled by clearing the
        forwarding address(es); for example:

        </p><pre class="screen">
&gt; <strong class="userinput"><code>config set Resolver/forward_addresses []</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      </p></div></div><div class="chapter" title="Chapter 12. DHCPv4 Server"><div class="titlepage"><div><div><h2 class="title"><a name="dhcp4"></a>Chapter 12. DHCPv4 Server</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#dhcp4-usage">12.1. DHCPv4 Server Usage</a></span></dt><dt><span class="section"><a href="#dhcp4-config">12.2. DHCPv4 Server Configuration</a></span></dt><dt><span class="section"><a href="#dhcp4-std">12.3. Supported standards</a></span></dt><dt><span class="section"><a href="#dhcp4-limit">12.4. DHCPv4 Server Limitations</a></span></dt></dl></div><p>Dynamic Host Configuration Protocol for IPv4 (DHCP or
    DHCPv4) and Dynamic Host Configuration Protocol for IPv6 (DHCPv6)
    are protocols that allow one node (server) to provision
    configuration parameters to many hosts and devices (clients). To
    ease deployment in larger networks, additional nodes (relays) may
    be deployed that facilitate communication between servers and
    clients. Even though principles of both DHCPv4 and DHCPv6 are
    somewhat similar, these are two radically different
    protocols. BIND10 offers server implementations for both DHCPv4
    and DHCPv6. This chapter is about DHCP for IPv4. For a description
    of the DHCPv6 server, see <a class="xref" href="#dhcp6" title="Chapter 13. DHCPv6 Server">Chapter 13, <i>DHCPv6 Server</i></a>.</p><p>The DHCPv4 server component is currently under intense
    development. You may want to check out <a class="ulink" href="http://bind10.isc.org/wiki/Kea" target="_top">BIND10 DHCP (Kea) wiki</a>
    and recent posts on <a class="ulink" href="https://lists.isc.org/mailman/listinfo/bind10-dev" target="_top">BIND10
    developers mailing list</a>.</p><p>The DHCPv4 and DHCPv6 components in BIND10 architecture are
    internally code named <span class="quote">&#8220;<span class="quote">Kea</span>&#8221;</span>.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        As of December 2011, both DHCPv4 and DHCPv6 components are
        skeleton servers. That means that while they are capable of
        performing DHCP configuration, they are not fully functional
        yet. In particular, neither has functional lease
        databases. This means that they will assign the same, fixed,
        hardcoded addresses to any client that will ask. See <a class="xref" href="#dhcp4-limit" title="12.4. DHCPv4 Server Limitations">Section 12.4, &#8220;DHCPv4 Server Limitations&#8221;</a> and <a class="xref" href="#dhcp6-limit" title="13.4. DHCPv6 Server Limitations">Section 13.4, &#8220;DHCPv6 Server Limitations&#8221;</a> for
        detailed description.
      </p></div><div class="section" title="12.1. DHCPv4 Server Usage"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp4-usage"></a>12.1. DHCPv4 Server Usage</h2></div></div></div><p>BIND10 provides the DHCPv4 server component since December
      2011. It is a skeleton server and can be described as an early
      prototype that is not fully functional yet. It is mature enough
      to conduct first tests in lab environment, but it has
      significant limitations. See <a class="xref" href="#dhcp4-limit" title="12.4. DHCPv4 Server Limitations">Section 12.4, &#8220;DHCPv4 Server Limitations&#8221;</a> for
      details.
      </p><p>
        The DHCPv4 server is implemented as <span class="command"><strong>b10-dhcp4</strong></span>
        daemon. As it is not configurable yet, it is fully autonomous,
        that is it does not interact with <span class="command"><strong>b10-cfgmgr</strong></span>.
        To start DHCPv4 server, simply input:

        </p><pre class="screen">
#<strong class="userinput"><code>cd src/bin/dhcp4</code></strong>
#<strong class="userinput"><code>./b10-dhcp4</code></strong>
</pre><p>

        Depending on your installation, <span class="command"><strong>b10-dhcp4</strong></span>
        binary may reside in src/bin/dhcp4 in your source code
        directory, in /usr/local/bin/b10-dhcp4 or other directory
        you specified during compilation.

        At start, the server will detect available network interfaces
        and will attempt to open UDP sockets on all interfaces that
        are up, running, are not loopback, and have IPv4 address
        assigned.

        The server will then listen to incoming traffic. Currently
        supported client messages are DISCOVER and REQUEST. The server
        will respond to them with OFFER and ACK, respectively.

        Since the DHCPv4 server opens privileged ports, it requires root
        access. Make sure you run this daemon as root.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Integration with <span class="command"><strong>bind10</strong></span> is
            planned. Ultimately, <span class="command"><strong>b10-dhcp4</strong></span> will not
            be started directly, but rather via
            <span class="command"><strong>bind10</strong></span>. Please be aware of this planned
            change.
          </p></div></div><div class="section" title="12.2. DHCPv4 Server Configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp4-config"></a>12.2. DHCPv4 Server Configuration</h2></div></div></div><p>
        The DHCPv4 server does not have a lease database implemented yet
        nor any support for configuration, so every time the same set
        of configuration options (including the same fixed address)
        will be assigned every time.
      </p><p>
        At this stage of development, the only way to alter the server
        configuration is to tweak its source code. To do so, please
        edit src/bin/dhcp4/dhcp4_srv.cc file and modify following
        parameters and recompile:
        </p><pre class="screen">
const std::string HARDCODED_LEASE = "192.0.2.222"; // assigned lease
const std::string HARDCODED_NETMASK = "255.255.255.0";
const uint32_t    HARDCODED_LEASE_TIME = 60; // in seconds
const std::string HARDCODED_GATEWAY = "192.0.2.1";
const std::string HARDCODED_DNS_SERVER = "192.0.2.2";
const std::string HARDCODED_DOMAIN_NAME = "isc.example.com";
const std::string HARDCODED_SERVER_ID = "192.0.2.1";</pre><p>

        Lease database and configuration support is planned for 2012.
      </p></div><div class="section" title="12.3. Supported standards"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp4-std"></a>12.3. Supported standards</h2></div></div></div><p>The following standards and draft standards are currently
      supported:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">RFC2131: Supported messages are DISCOVER, OFFER,
            REQUEST, and ACK.</li><li class="listitem">RFC2132: Supported options are: PAD (0),
            END(255), Message Type(53), DHCP Server Identifier (54),
            Domain Name (15), DNS Servers (6), IP Address Lease Time
            (51), Subnet mask (1), and Routers (3).</li></ul></div></div><div class="section" title="12.4. DHCPv4 Server Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp4-limit"></a>12.4. DHCPv4 Server Limitations</h2></div></div></div><p>These are the current limitations of the DHCPv4 server
      software. Most of them are reflections of the early stage of
      development and should be treated as <span class="quote">&#8220;<span class="quote">not implemented
      yet</span>&#8221;</span>, rather than actual limitations.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">During initial IPv4 node configuration, the
            server is expected to send packets to a node that does not
            have IPv4 address assigned yet. The server requires
            certain tricks (or hacks) to transmit such packets. This
            is not implemented yet, therefore DHCPv4 server supports
            relayed traffic only (that is, normal point to point
            communication).</li><li class="listitem"><span class="command"><strong>b10-dhcp4</strong></span> provides a single,
            fixed, hardcoded lease to any client that asks.  There is
            no lease manager implemented. If two clients request
            addresses, they will both get the same fixed
            address.</li><li class="listitem"><span class="command"><strong>b10-dhcp4</strong></span> does not support any
            configuration mechanisms yet. The whole configuration is
            currently hardcoded. The only way to tweak configuration
            is to directly modify source code. See see <a class="xref" href="#dhcp4-config" title="12.2. DHCPv4 Server Configuration">Section 12.2, &#8220;DHCPv4 Server Configuration&#8221;</a> for details.</li><li class="listitem">Upon start, the server will open sockets on all
            interfaces that are not loopback, are up and running and
            have IPv4 address.  Support for multiple interfaces is not
            coded in reception routines yet, so if you are running
            this code on a machine that has many interfaces and
            <span class="command"><strong>b10-dhcp4</strong></span> happens to listen on wrong
            interface, the easiest way to work around this problem is
            to turn down other interfaces. This limitation will be
            fixed shortly.</li><li class="listitem">PRL (Parameter Request List, a list of options
            requested by a client) is currently ignored and server
            assigns DNS SERVER and DOMAIN NAME options.</li><li class="listitem"><span class="command"><strong>b10-dhcp4</strong></span> does not support
            BOOTP. That is a design choice. This limitation is
            permanent. If you have legacy nodes that can't use DHCP and
            require BOOTP support, please use latest version of ISC DHCP
            <a class="ulink" href="http://www.isc.org/software/dhcp" target="_top">http://www.isc.org/software/dhcp</a>.</li><li class="listitem">Interface detection is currently working on Linux
            only. See <a class="xref" href="#iface-detect" title="14.1. Interface detection">Section 14.1, &#8220;Interface detection&#8221;</a> for details.</li><li class="listitem"><span class="command"><strong>b10-dhcp4</strong></span> does not verify that
            assigned address is unused. According to RFC2131, the
            allocating server should verify that address is no used by
            sending ICMP echo request.</li><li class="listitem">Address renewal (RENEW), rebinding (REBIND),
            confirmation (CONFIRM), duplication report (DECLINE) and
            release (RELEASE) are not supported yet.</li><li class="listitem">DNS Update is not supported yet.</li><li class="listitem">-v (verbose) command line option is currently
            the default, and cannot be disabled.</li></ul></div></div></div><div class="chapter" title="Chapter 13. DHCPv6 Server"><div class="titlepage"><div><div><h2 class="title"><a name="dhcp6"></a>Chapter 13. DHCPv6 Server</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#dhcp6-usage">13.1. DHCPv6 Server Usage</a></span></dt><dt><span class="section"><a href="#dhcp6-config">13.2. DHCPv6 Server Configuration</a></span></dt><dt><span class="section"><a href="#dhcp6-std">13.3. Supported DHCPv6 Standards</a></span></dt><dt><span class="section"><a href="#dhcp6-limit">13.4. DHCPv6 Server Limitations</a></span></dt></dl></div><p>Dynamic Host Configuration Protocol for IPv6 (DHCPv6) is
    specified in RFC3315. BIND10 provides DHCPv6 server implementation
    that is described in this chapter. For a description of the DHCPv4
    server implementation, see <a class="xref" href="#dhcp4" title="Chapter 12. DHCPv4 Server">Chapter 12, <i>DHCPv4 Server</i></a>.
    </p><p>The DHCPv6 server component is currently under intense
    development. You may want to check out <a class="ulink" href="http://bind10.isc.org/wiki/Kea" target="_top">BIND10 DHCP (Kea) wiki</a>
    and recent posts on <a class="ulink" href="https://lists.isc.org/mailman/listinfo/bind10-dev" target="_top">BIND10
    developers mailing list</a>.</p><p>The DHCPv4 and DHCPv6 components in BIND10 architecture are
    internally code named <span class="quote">&#8220;<span class="quote">Kea</span>&#8221;</span>.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        As of December 2011, both DHCPv4 and DHCPv6 components are
        skeleton servers. That means that while they are capable of
        performing DHCP configuration, they are not fully functional
        yet. In particular, neither has functional lease
        databases. This means that they will assign the same, fixed,
        hardcoded addresses to any client that will ask. See <a class="xref" href="#dhcp4-limit" title="12.4. DHCPv4 Server Limitations">Section 12.4, &#8220;DHCPv4 Server Limitations&#8221;</a> and <a class="xref" href="#dhcp6-limit" title="13.4. DHCPv6 Server Limitations">Section 13.4, &#8220;DHCPv6 Server Limitations&#8221;</a> for
        detailed description.
      </p></div><div class="section" title="13.1. DHCPv6 Server Usage"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp6-usage"></a>13.1. DHCPv6 Server Usage</h2></div></div></div><p>
        BIND10 provides the DHCPv6 server component since September
        2011. It is a skeleton server and can be described as an early
        prototype that is not fully functional yet. It is mature
        enough to conduct first tests in lab environment, but it has
        significant limitations. See <a class="xref" href="#dhcp6-limit" title="13.4. DHCPv6 Server Limitations">Section 13.4, &#8220;DHCPv6 Server Limitations&#8221;</a> for
        details.
      </p><p>
        The DHCPv6 server is implemented as <span class="command"><strong>b10-dhcp6</strong></span>
        daemon. As it is not configurable yet, it is fully autonomous,
        that is it does not interact with <span class="command"><strong>b10-cfgmgr</strong></span>.
        To start DHCPv6 server, simply input:

        </p><pre class="screen">
#<strong class="userinput"><code>cd src/bin/dhcp6</code></strong>
#<strong class="userinput"><code>./b10-dhcp6</code></strong>
</pre><p>

        Depending on your installation, <span class="command"><strong>b10-dhcp6</strong></span>
        binary may reside in src/bin/dhcp6 in your source code
        directory, in /usr/local/bin/b10-dhcp6 or other directory
        you specified during compilation.

        At start, server will detect available network interfaces
        and will attempt to open UDP sockets on all interfaces that
        are up, running, are not loopback, are multicast-capable, and
        have IPv6 address assigned.

        The server will then listen to incoming traffic. Currently
        supported client messages are SOLICIT and REQUEST. The server
        will respond to them with ADVERTISE and REPLY, respectively.

        Since the DHCPv6 server opens privileged ports, it requires root
        access. Make sure you run this daemon as root.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Integration with <span class="command"><strong>bind10</strong></span> is
            planned. Ultimately, <span class="command"><strong>b10-dhcp6</strong></span> will not
            be started directly, but rather via
            <span class="command"><strong>bind10</strong></span>. Please be aware of this planned
            change.
          </p></div></div><div class="section" title="13.2. DHCPv6 Server Configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp6-config"></a>13.2. DHCPv6 Server Configuration</h2></div></div></div><p>
        The DHCPv6 server does not have lease database implemented yet
        or any support for configuration, so every time the same set
        of configuration options (including the same fixed address)
        will be assigned every time.
      </p><p>
        At this stage of development, the only way to alter server
        configuration is to tweak its source code. To do so, please
        edit src/bin/dhcp6/dhcp6_srv.cc file and modify following
        parameters and recompile:
        </p><pre class="screen">
const std::string HARDCODED_LEASE = "2001:db8:1::1234:abcd";
const uint32_t HARDCODED_T1 = 1500; // in seconds
const uint32_t HARDCODED_T2 = 2600; // in seconds
const uint32_t HARDCODED_PREFERRED_LIFETIME = 3600; // in seconds
const uint32_t HARDCODED_VALID_LIFETIME = 7200; // in seconds
const std::string HARDCODED_DNS_SERVER = "2001:db8:1::1";</pre><p>

        Lease database and configuration support is planned for 2012.
      </p></div><div class="section" title="13.3. Supported DHCPv6 Standards"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp6-std"></a>13.3. Supported DHCPv6 Standards</h2></div></div></div><p>The following standards and draft standards are currently
      supported:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">RFC3315: Supported messages are SOLICIT,
            ADVERTISE, REQUEST, and REPLY. Supported options are
            SERVER_ID, CLIENT_ID, IA_NA, and IAADDRESS.</li><li class="listitem">RFC3646: Supported option is DNS_SERVERS.</li></ul></div></div><div class="section" title="13.4. DHCPv6 Server Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp6-limit"></a>13.4. DHCPv6 Server Limitations</h2></div></div></div><p> These are the current limitations of the DHCPv6 server
      software. Most of them are reflections of the early stage of
      development and should be treated as <span class="quote">&#8220;<span class="quote">not implemented
      yet</span>&#8221;</span>, rather than actual limitations.</p><p>
      </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Relayed traffic is not supported.</li><li class="listitem"><span class="command"><strong>b10-dhcp6</strong></span> provides a single,
          fixed, hardcoded lease to any client that asks. There is no
          lease manager implemented. If two clients request addresses,
          they will both get the same fixed address.</li><li class="listitem"><span class="command"><strong>b10-dhcp6</strong></span> does not support any
            configuration mechanisms yet. The whole configuration is
            currently hardcoded. The only way to tweak configuration
            is to directly modify source code. See see <a class="xref" href="#dhcp6-config" title="13.2. DHCPv6 Server Configuration">Section 13.2, &#8220;DHCPv6 Server Configuration&#8221;</a> for details.</li><li class="listitem">Upon start, the server will open sockets on all
          interfaces that are not loopback, are up, running and are
          multicast capable and have IPv6 address.  Support for
          multiple interfaces is not coded in reception routines yet,
          so if you are running this code on a machine that has many
          interfaces and <span class="command"><strong>b10-dhcp6</strong></span> happens to
          listen on wrong interface, the easiest way to work around
          this problem is to turn down other interfaces. This
          limitation will be fixed shortly.</li><li class="listitem">ORO (Option Request Option, a list of options
          requested by a client) is currently ignored and server
          assigns DNS SERVER option.</li><li class="listitem">Temporary addresses are not supported yet.</li><li class="listitem">Prefix delegation is not supported yet.</li><li class="listitem">Address renewal (RENEW), rebinding (REBIND),
          confirmation (CONFIRM), duplication report (DECLINE) and
          release (RELEASE) are not supported yet.</li><li class="listitem">DNS Update is not supported yet.</li><li class="listitem">Interface detection is currently working on Linux
          only. See <a class="xref" href="#iface-detect" title="14.1. Interface detection">Section 14.1, &#8220;Interface detection&#8221;</a> for details.</li><li class="listitem">-v (verbose) command line option is currently the
          default, and cannot be disabled.</li></ul></div><p>
      </p></div></div><div class="chapter" title="Chapter 14. libdhcp++ library"><div class="titlepage"><div><div><h2 class="title"><a name="libdhcp"></a>Chapter 14. libdhcp++ library</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#iface-detect">14.1. Interface detection</a></span></dt><dt><span class="section"><a href="#packet-handling">14.2. DHCPv4/DHCPv6 packet handling</a></span></dt></dl></div><p>libdhcp++ is a common library written in C++ that handles
    many DHCP-related tasks, like DHCPv4 and DHCPv6 packets parsing,
    manipulation and assembly, option parsing, manipulation and
    assembly, network interface detection and socket operations, like
    socket creations, data transmission and reception and socket
    closing.
    </p><p>
    While this library is currently used by
    <span class="command"><strong>b10-dhcp4</strong></span> and <span class="command"><strong>b10-dhcp6</strong></span>
    only, it is designed to be portable, universal library useful for
    any kind of DHCP-related software.
    </p><div class="section" title="14.1. Interface detection"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="iface-detect"></a>14.1. Interface detection</h2></div></div></div><p>Both DHCPv4 and DHCPv6 components share network
      interface detection routines. Interface detection is
      currently only supported on Linux systems.</p><p>For non-Linux systems, there is currently stub
      implementation provided. As DHCP servers need to know available
      addresses, there is a simple mechanism implemented to provide
      that information. User is expected to create interfaces.txt
      file. Format of this file is simple. It contains list of
      interfaces along with available address on each interface. This
      mechanism is temporary and is going to be removed as soon as
      interface detection becomes available on non-Linux
      systems. Here is an example of the interfaces.txt file:
      </p><pre class="screen">
# For DHCPv6, please specify link-local address (starts with fe80::)
# If in doubt, check output of 'ifconfig -a' command.
eth0 fe80::21e:8cff:fe9b:7349

# For DHCPv4, please use following format:
#eth0 192.0.2.5</pre><p>
      </p></div><div class="section" title="14.2. DHCPv4/DHCPv6 packet handling"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="packet-handling"></a>14.2. DHCPv4/DHCPv6 packet handling</h2></div></div></div><p>TODO: Describe packet handling here, with pointers to wiki</p></div></div><div class="chapter" title="Chapter 15. Statistics"><div class="titlepage"><div><div><h2 class="title"><a name="statistics"></a>Chapter 15. Statistics</h2></div></div></div><p>
      The <span class="command"><strong>b10-stats</strong></span> process is started by
      <span class="command"><strong>bind10</strong></span>.
      It periodically collects statistics data from various modules
      and aggregates it.

    </p><p>

       This stats daemon provides commands to identify if it is
       running, show specified or all statistics data, show specified
       or all statistics data schema, and set specified statistics
       data.

       For example, using <span class="command"><strong>bindctl</strong></span>:

       </p><pre class="screen">
&gt; <strong class="userinput"><code>Stats show</code></strong>
{
    "Auth": {
        "opcode.iquery": 0,
        "opcode.notify": 10,
        "opcode.query": 869617,
        ...
        "queries.tcp": 1749,
        "queries.udp": 867868
    },
    "Boss": {
        "boot_time": "2011-01-20T16:59:03Z"
    },
    "Stats": {
        "boot_time": "2011-01-20T16:59:05Z",
        "last_update_time": "2011-01-20T17:04:05Z",
        "lname": "4d3869d9_a@jreed.example.net",
        "report_time": "2011-01-20T17:04:06Z",
        "timestamp": 1295543046.823504
    }
}
       </pre><p>
    </p></div><div class="chapter" title="Chapter 16. Logging"><div class="titlepage"><div><div><h2 class="title"><a name="logging"></a>Chapter 16. Logging</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idp327280">16.1. Logging configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#idp328272">16.1.1. Loggers</a></span></dt><dt><span class="section"><a href="#idp349480">16.1.2. Output Options</a></span></dt><dt><span class="section"><a href="#idp362088">16.1.3. Example session</a></span></dt></dl></dd><dt><span class="section"><a href="#idp379592">16.2. Logging Message Format</a></span></dt></dl></div><div class="section" title="16.1. Logging configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp327280"></a>16.1. Logging configuration</h2></div></div></div><p>

        The logging system in BIND 10 is configured through the
        Logging module. All BIND 10 modules will look at the
        configuration in Logging to see what should be logged and
        to where.



      </p><div class="section" title="16.1.1. Loggers"><div class="titlepage"><div><div><h3 class="title"><a name="idp328272"></a>16.1.1. Loggers</h3></div></div></div><p>

          Within BIND 10, a message is logged through a component
          called a "logger". Different parts of BIND 10 log messages
          through different loggers, and each logger can be configured
          independently of one another.

        </p><p>

          In the Logging module, you can specify the configuration
          for zero or more loggers; any that are not specified will
          take appropriate default values..

        </p><p>

          The three most important elements of a logger configuration
          are the <code class="option">name</code> (the component that is
          generating the messages), the <code class="option">severity</code>
          (what to log), and the <code class="option">output_options</code>
          (where to log).

        </p><div class="section" title="16.1.1.1. name (string)"><div class="titlepage"><div><div><h4 class="title"><a name="idp330520"></a>16.1.1.1. name (string)</h4></div></div></div><p>
          Each logger in the system has a name, the name being that
          of the component using it to log messages. For instance,
          if you want to configure logging for the resolver module,
          you add an entry for a logger named <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>. This
          configuration will then be used by the loggers in the
          Resolver module, and all the libraries used by it.
              </p><p>

          If you want to specify logging for one specific library
          within the module, you set the name to
          <em class="replaceable"><code>module.library</code></em>.  For example, the
          logger used by the nameserver address store component
          has the full name of <span class="quote">&#8220;<span class="quote">Resolver.nsas</span>&#8221;</span>. If
          there is no entry in Logging for a particular library,
          it will use the configuration given for the module.



        </p><p>



          To illustrate this, suppose you want the cache library
          to log messages of severity DEBUG, and the rest of the
          resolver code to log messages of severity INFO. To achieve
          this you specify two loggers, one with the name
          <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span> and severity INFO, and one with
          the name <span class="quote">&#8220;<span class="quote">Resolver.cache</span>&#8221;</span> with severity
          DEBUG. As there are no entries for other libraries (e.g.
          the nsas), they will use the configuration for the module
          (<span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>), so giving the desired behavior.

        </p><p>

          One special case is that of a module name of <span class="quote">&#8220;<span class="quote">*</span>&#8221;</span>
          (asterisks), which is interpreted as <span class="emphasis"><em>any</em></span>
          module. You can set global logging options by using this,
          including setting the logging configuration for a library
          that is used by multiple modules (e.g. <span class="quote">&#8220;<span class="quote">*.config</span>&#8221;</span>
          specifies the configuration library code in whatever
          module is using it).

        </p><p>

          If there are multiple logger specifications in the
          configuration that might match a particular logger, the
          specification with the more specific logger name takes
          precedence. For example, if there are entries for for
          both <span class="quote">&#8220;<span class="quote">*</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>, the
          resolver module &#8212; and all libraries it uses &#8212;
          will log messages according to the configuration in the
          second entry (<span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>). All other modules
          will use the configuration of the first entry
          (<span class="quote">&#8220;<span class="quote">*</span>&#8221;</span>). If there was also a configuration
          entry for <span class="quote">&#8220;<span class="quote">Resolver.cache</span>&#8221;</span>, the cache library
          within the resolver would use that in preference to the
          entry for <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>.

        </p><p>

          One final note about the naming. When specifying the
          module name within a logger, use the name of the module
          as specified in <span class="command"><strong>bindctl</strong></span>, e.g.
          <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span> for the resolver module,
          <span class="quote">&#8220;<span class="quote">Xfrout</span>&#8221;</span> for the xfrout module, etc. When
          the message is logged, the message will include the name
          of the logger generating the message, but with the module
          name replaced by the name of the process implementing
          the module (so for example, a message generated by the
          <span class="quote">&#8220;<span class="quote">Auth.cache</span>&#8221;</span> logger will appear in the output
          with a logger name of <span class="quote">&#8220;<span class="quote">b10-auth.cache</span>&#8221;</span>).

        </p></div><div class="section" title="16.1.1.2. severity (string)"><div class="titlepage"><div><div><h4 class="title"><a name="idp340304"></a>16.1.1.2. severity (string)</h4></div></div></div><p>

          This specifies the category of messages logged.
          Each message is logged with an associated severity which
          may be one of the following (in descending order of
          severity):
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"> FATAL </li><li class="listitem"> ERROR </li><li class="listitem"> WARN </li><li class="listitem"> INFO </li><li class="listitem"> DEBUG </li></ul></div><p>

          When the severity of a logger is set to one of these
          values, it will only log messages of that severity, and
          the severities above it. The severity may also be set to
          NONE, in which case all messages from that logger are
          inhibited.



        </p></div><div class="section" title="16.1.1.3. output_options (list)"><div class="titlepage"><div><div><h4 class="title"><a name="idp344096"></a>16.1.1.3. output_options (list)</h4></div></div></div><p>

          Each logger can have zero or more
          <code class="option">output_options</code>. These specify where log
          messages are sent to. These are explained in detail below.

        </p><p>

          The other options for a logger are:

        </p></div><div class="section" title="16.1.1.4. debuglevel (integer)"><div class="titlepage"><div><div><h4 class="title"><a name="idp345320"></a>16.1.1.4. debuglevel (integer)</h4></div></div></div><p>

          When a logger's severity is set to DEBUG, this value
          specifies what debug messages should be printed. It ranges
          from 0 (least verbose) to 99 (most verbose).
        </p><p>

          If severity for the logger is not DEBUG, this value is ignored.

        </p></div><div class="section" title="16.1.1.5. additive (true or false)"><div class="titlepage"><div><div><h4 class="title"><a name="idp346760"></a>16.1.1.5. additive (true or false)</h4></div></div></div><p>

          If this is true, the <code class="option">output_options</code> from
          the parent will be used. For example, if there are two
          loggers configured; <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span> and
          <span class="quote">&#8220;<span class="quote">Resolver.cache</span>&#8221;</span>, and <code class="option">additive</code>
          is true in the second, it will write the log messages
          not only to the destinations specified for
          <span class="quote">&#8220;<span class="quote">Resolver.cache</span>&#8221;</span>, but also to the destinations
          as specified in the <code class="option">output_options</code> in
          the logger named <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>.



      </p></div></div><div class="section" title="16.1.2. Output Options"><div class="titlepage"><div><div><h3 class="title"><a name="idp349480"></a>16.1.2. Output Options</h3></div></div></div><p>

          The main settings for an output option are the
          <code class="option">destination</code> and a value called
          <code class="option">output</code>, the meaning of which depends on
          the destination that is set.

        </p><div class="section" title="16.1.2.1. destination (string)"><div class="titlepage"><div><div><h4 class="title"><a name="idp350616"></a>16.1.2.1. destination (string)</h4></div></div></div><p>

            The destination is the type of output. It can be one of:

          </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"> console </li><li class="listitem"> file </li><li class="listitem"> syslog </li></ul></div></div><div class="section" title="16.1.2.2. output (string)"><div class="titlepage"><div><div><h4 class="title"><a name="idp352704"></a>16.1.2.2. output (string)</h4></div></div></div><p>

          Depending on what is set as the output destination, this
          value is interpreted as follows:

        </p><div class="variablelist"><dl><dt><span class="term"><code class="option">destination</code> is <span class="quote">&#8220;<span class="quote">console</span>&#8221;</span></span></dt><dd>
                 The value of output must be one of <span class="quote">&#8220;<span class="quote">stdout</span>&#8221;</span>
                 (messages printed to standard output) or
                 <span class="quote">&#8220;<span class="quote">stderr</span>&#8221;</span> (messages printed to standard
                 error).
              </dd><dt><span class="term"><code class="option">destination</code> is <span class="quote">&#8220;<span class="quote">file</span>&#8221;</span></span></dt><dd>
                The value of output is interpreted as a file name;
                log messages will be appended to this file.
              </dd><dt><span class="term"><code class="option">destination</code> is <span class="quote">&#8220;<span class="quote">syslog</span>&#8221;</span></span></dt><dd>
                The value of output is interpreted as the
                <span class="command"><strong>syslog</strong></span> facility (e.g.
                <span class="emphasis"><em>local0</em></span>) that should be used
                for log messages.
              </dd></dl></div><p>

          The other options for <code class="option">output_options</code> are:

        </p><div class="section" title="16.1.2.2.1. flush (true of false)"><div class="titlepage"><div><div><h5 class="title"><a name="idp358664"></a>16.1.2.2.1. flush (true of false)</h5></div></div></div><p>
            Flush buffers after each log message. Doing this will
            reduce performance but will ensure that if the program
            terminates abnormally, all messages up to the point of
            termination are output.
          </p></div><div class="section" title="16.1.2.2.2. maxsize (integer)"><div class="titlepage"><div><div><h5 class="title"><a name="idp359528"></a>16.1.2.2.2. maxsize (integer)</h5></div></div></div><p>
            Only relevant when destination is file, this is maximum
            file size of output files in bytes. When the maximum
            size is reached, the file is renamed and a new file opened.
            (For example, a ".1" is appended to the name &#8212;
            if a ".1" file exists, it is renamed ".2",
            etc.)
          </p><p>
            If this is 0, no maximum file size is used.
          </p></div><div class="section" title="16.1.2.2.3. maxver (integer)"><div class="titlepage"><div><div><h5 class="title"><a name="idp360776"></a>16.1.2.2.3. maxver (integer)</h5></div></div></div><p>
            Maximum number of old log files to keep around when
            rolling the output file. Only relevant when
            <code class="option">destination</code> is <span class="quote">&#8220;<span class="quote">file</span>&#8221;</span>.
          </p></div></div></div><div class="section" title="16.1.3. Example session"><div class="titlepage"><div><div><h3 class="title"><a name="idp362088"></a>16.1.3. Example session</h3></div></div></div><p>

          In this example we want to set the global logging to
          write to the file <code class="filename">/var/log/my_bind10.log</code>,
          at severity WARN. We want the authoritative server to
          log at DEBUG with debuglevel 40, to a different file
          (<code class="filename">/tmp/debug_messages</code>).

        </p><p>

          Start <span class="command"><strong>bindctl</strong></span>.

        </p><p>

           </p><pre class="screen">["login success "]
&gt; <strong class="userinput"><code>config show Logging</code></strong>
Logging/loggers	[]	list
</pre><p>

        </p><p>

          By default, no specific loggers are configured, in which
          case the severity defaults to INFO and the output is
          written to stderr.

        </p><p>

          Let's first add a default logger:

        </p><p>

          </p><pre class="screen"><strong class="userinput"><code>&gt; config add Logging/loggers</code></strong>
&gt; <strong class="userinput"><code>config show Logging</code></strong>
Logging/loggers/	list	(modified)
</pre><p>

        </p><p>

          The loggers value line changed to indicate that it is no
          longer an empty list:

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code>config show Logging/loggers</code></strong>
Logging/loggers[0]/name	""	string	(default)
Logging/loggers[0]/severity	"INFO"	string	(default)
Logging/loggers[0]/debuglevel	0	integer	(default)
Logging/loggers[0]/additive	false	boolean	(default)
Logging/loggers[0]/output_options	[]	list	(default)
</pre><p>

        </p><p>

          The name is mandatory, so we must set it. We will also
          change the severity as well. Let's start with the global
          logger.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code>config set Logging/loggers[0]/name *</code></strong>
&gt; <strong class="userinput"><code>config set Logging/loggers[0]/severity WARN</code></strong>
&gt; <strong class="userinput"><code>config show Logging/loggers</code></strong>
Logging/loggers[0]/name	"*"	string	(modified)
Logging/loggers[0]/severity	"WARN"	string	(modified)
Logging/loggers[0]/debuglevel	0	integer	(default)
Logging/loggers[0]/additive	false	boolean	(default)
Logging/loggers[0]/output_options	[]	list	(default)
</pre><p>

        </p><p>

          Of course, we need to specify where we want the log
          messages to go, so we add an entry for an output option.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config add Logging/loggers[0]/output_options</code></strong>
&gt; <strong class="userinput"><code> config show Logging/loggers[0]/output_options</code></strong>
Logging/loggers[0]/output_options[0]/destination	"console"	string	(default)
Logging/loggers[0]/output_options[0]/output	"stdout"	string	(default)
Logging/loggers[0]/output_options[0]/flush	false	boolean	(default)
Logging/loggers[0]/output_options[0]/maxsize	0	integer	(default)
Logging/loggers[0]/output_options[0]/maxver	0	integer	(default)
</pre><p>


        </p><p>

          These aren't the values we are looking for.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config set Logging/loggers[0]/output_options[0]/destination file</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[0]/output_options[0]/output /var/log/bind10.log</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[0]/output_options[0]/maxsize 30000</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[0]/output_options[0]/maxver 8</code></strong>
</pre><p>

        </p><p>

          Which would make the entire configuration for this logger
          look like:

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config show all Logging/loggers</code></strong>
Logging/loggers[0]/name	"*"	string	(modified)
Logging/loggers[0]/severity	"WARN"	string	(modified)
Logging/loggers[0]/debuglevel	0	integer	(default)
Logging/loggers[0]/additive	false	boolean	(default)
Logging/loggers[0]/output_options[0]/destination	"file"	string	(modified)
Logging/loggers[0]/output_options[0]/output	"/var/log/bind10.log"	string	(modified)
Logging/loggers[0]/output_options[0]/flush	false	boolean	(default)
Logging/loggers[0]/output_options[0]/maxsize	30000	integer	(modified)
Logging/loggers[0]/output_options[0]/maxver	8	integer	(modified)
</pre><p>

        </p><p>

          That looks OK, so let's commit it before we add the
          configuration for the authoritative server's logger.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config commit</code></strong></pre><p>

        </p><p>

          Now that we have set it, and checked each value along
          the way, adding a second entry is quite similar.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config add Logging/loggers</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/name Auth</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/severity DEBUG</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/debuglevel 40</code></strong>
&gt; <strong class="userinput"><code> config add Logging/loggers[1]/output_options</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/output_options[0]/destination file</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/output_options[0]/output /tmp/auth_debug.log</code></strong>
&gt; <strong class="userinput"><code> config commit</code></strong>
</pre><p>

        </p><p>

          And that's it. Once we have found whatever it was we
          needed the debug messages for, we can simply remove the
          second logger to let the authoritative server use the
          same settings as the rest.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config remove Logging/loggers[1]</code></strong>
&gt; <strong class="userinput"><code> config commit</code></strong>
</pre><p>

        </p><p>

          And every module will now be using the values from the
          logger named <span class="quote">&#8220;<span class="quote">*</span>&#8221;</span>.

        </p></div></div><div class="section" title="16.2. Logging Message Format"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp379592"></a>16.2. Logging Message Format</h2></div></div></div><p>
          Each message written by BIND 10 to the configured logging
          destinations comprises a number of components that identify
          the origin of the message and, if the message indicates
          a problem, information about the problem that may be
          useful in fixing it.
      </p><p>
          Consider the message below logged to a file:
          </p><pre class="screen">2011-06-15 13:48:22.034 ERROR [b10-resolver.asiolink]
    ASIODNS_OPENSOCK error 111 opening TCP socket to 127.0.0.1(53)</pre><p>
      </p><p>
        Note: the layout of messages written to the system logging
        file (syslog) may be slightly different.  This message has
        been split across two lines here for display reasons; in the
        logging file, it will appear on one line.)
      </p><p>
        The log message comprises a number of components:

          </p><div class="variablelist"><dl><dt><span class="term">2011-06-15 13:48:22.034</span></dt><dd><p>
              The date and time at which the message was generated.
          </p></dd><dt><span class="term">ERROR</span></dt><dd><p>
              The severity of the message.
          </p></dd><dt><span class="term">[b10-resolver.asiolink]</span></dt><dd><p>
            The source of the message.  This comprises two components:
            the BIND 10 process generating the message (in this
            case, <span class="command"><strong>b10-resolver</strong></span>) and the module
            within the program from which the message originated
            (which in the example is the asynchronous I/O link
            module, asiolink).
          </p></dd><dt><span class="term">ASIODNS_OPENSOCK</span></dt><dd><p>
            The message identification.  Every message in BIND 10
            has a unique identification, which can be used as an
            index into the <a class="ulink" href="bind10-messages.html" target="_top"><em class="citetitle">BIND 10 Messages
            Manual</em></a> (<a class="ulink" href="http://bind10.isc.org/docs/bind10-messages.html" target="_top">http://bind10.isc.org/docs/bind10-messages.html</a>) from which more information can be obtained.
          </p></dd><dt><span class="term">error 111 opening TCP socket to 127.0.0.1(53)</span></dt><dd><p>
              A brief description of the cause of the problem.
              Within this text, information relating to the condition
              that caused the message to be logged will be included.
              In this example, error number 111 (an operating
              system-specific error number) was encountered when
              trying to open a TCP connection to port 53 on the
              local system (address 127.0.0.1).  The next step
              would be to find out the reason for the failure by
              consulting your system's documentation to identify
              what error number 111 means.
          </p></dd></dl></div><p>
      </p></div></div></div></body></html>
