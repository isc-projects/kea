#!@PYTHON@

import sys; sys.path.append ('@@PYTHONPATH@@')

from cfgmgr import ConfigManager
import signal
import os

cm = None

def signal_handler(signal, frame):
    global cm
    if cm:
        cm.running = False

if __name__ == "__main__":
    try:
        cm = ConfigManager()
        signal.signal(signal.SIGINT, signal_handler)
        signal.signal(signal.SIGTERM, signal_handler)
        cm.read_config()
        cm.notify_boss()
        cm.run()
    except ISC.CC.SessionError as se:
        print("[bind-cfgd] Error creating config manager, "
              "is the command channel daemon running?")
    except KeyboardInterrupt as kie:
        print("Got ctrl-c, exit")
    cm.write_config()
